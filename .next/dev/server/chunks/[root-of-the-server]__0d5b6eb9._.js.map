{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azhaa/DevKnight-DMS/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies()\r\n\r\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\r\n    cookies: {\r\n      getAll() {\r\n        return cookieStore.getAll()\r\n      },\r\n      setAll(cookiesToSet) {\r\n        try {\r\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\r\n        } catch {\r\n          // Server Component - can be ignored\r\n        }\r\n      },\r\n    },\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2QAAO;IAEjC,OAAO,IAAA,8SAAkB,oKAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,oCAAoC;gBACtC;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azhaa/DevKnight-DMS/app/api/documents/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { createClient } from \"@/lib/supabase/server\"\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient()\r\n    const { searchParams } = new URL(request.url)\r\n\r\n    // Get filter parameters\r\n    const search = searchParams.get(\"search\") || \"\"\r\n    const types = searchParams.get(\"types\")?.split(\",\").filter(Boolean) || []\r\n    const companies = searchParams.get(\"companies\")?.split(\",\").filter(Boolean) || []\r\n    const dateFrom = searchParams.get(\"dateFrom\")\r\n    const dateTo = searchParams.get(\"dateTo\")\r\n    const sortBy = searchParams.get(\"sortBy\") || \"iso_date\"\r\n    const sortOrder = searchParams.get(\"sortOrder\") || \"desc\"\r\n\r\n    // Build query\r\n    let query = supabase.from(\"documents\").select(\"*\")\r\n\r\n    // Apply omni-search (searches across type, company, serial, filename)\r\n    if (search) {\r\n      query = query.or(\r\n        `doc_type.ilike.%${search}%,company_name.ilike.%${search}%,doc_serial.ilike.%${search}%,file_name.ilike.%${search}%`,\r\n      )\r\n    }\r\n\r\n    // Apply type filter\r\n    if (types.length > 0) {\r\n      query = query.in(\"doc_type\", types)\r\n    }\r\n\r\n    // Apply company filter\r\n    if (companies.length > 0) {\r\n      query = query.in(\"company_name\", companies)\r\n    }\r\n\r\n    // Apply date range filter\r\n    if (dateFrom) {\r\n      query = query.gte(\"iso_date\", dateFrom)\r\n    }\r\n    if (dateTo) {\r\n      query = query.lte(\"iso_date\", dateTo)\r\n    }\r\n\r\n    // Apply sorting\r\n    query = query.order(sortBy, { ascending: sortOrder === \"asc\" })\r\n\r\n    const { data, error } = await query\r\n\r\n    if (error) {\r\n      console.error(\"Database error:\", error)\r\n      return NextResponse.json({ error: \"Failed to fetch documents\" }, { status: 500 })\r\n    }\r\n\r\n    return NextResponse.json({ documents: data || [] })\r\n  } catch (error) {\r\n    console.error(\"Fetch error:\", error)\r\n    return NextResponse.json({ error: \"Failed to fetch documents\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2IAAY;QACnC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,wBAAwB;QACxB,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;QAC7C,MAAM,QAAQ,aAAa,GAAG,CAAC,UAAU,MAAM,KAAK,OAAO,YAAY,EAAE;QACzE,MAAM,YAAY,aAAa,GAAG,CAAC,cAAc,MAAM,KAAK,OAAO,YAAY,EAAE;QACjF,MAAM,WAAW,aAAa,GAAG,CAAC;QAClC,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;QAC7C,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB;QAEnD,cAAc;QACd,IAAI,QAAQ,SAAS,IAAI,CAAC,aAAa,MAAM,CAAC;QAE9C,sEAAsE;QACtE,IAAI,QAAQ;YACV,QAAQ,MAAM,EAAE,CACd,CAAC,gBAAgB,EAAE,OAAO,sBAAsB,EAAE,OAAO,oBAAoB,EAAE,OAAO,mBAAmB,EAAE,OAAO,CAAC,CAAC;QAExH;QAEA,oBAAoB;QACpB,IAAI,MAAM,MAAM,GAAG,GAAG;YACpB,QAAQ,MAAM,EAAE,CAAC,YAAY;QAC/B;QAEA,uBAAuB;QACvB,IAAI,UAAU,MAAM,GAAG,GAAG;YACxB,QAAQ,MAAM,EAAE,CAAC,gBAAgB;QACnC;QAEA,0BAA0B;QAC1B,IAAI,UAAU;YACZ,QAAQ,MAAM,GAAG,CAAC,YAAY;QAChC;QACA,IAAI,QAAQ;YACV,QAAQ,MAAM,GAAG,CAAC,YAAY;QAChC;QAEA,gBAAgB;QAChB,QAAQ,MAAM,KAAK,CAAC,QAAQ;YAAE,WAAW,cAAc;QAAM;QAE7D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,mBAAmB;YACjC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,WAAW,QAAQ,EAAE;QAAC;IACnD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}